= provide(:title, "New Payment")

.row
  %h1 New Payment
  - if @current_customer.payment_profiles.empty?
    %p You do not currently have any linked payment accounts.  Create a new one now.
    - if can?(:create, PaymentProfile)
      = link_to "Add Payment Method", new_customer_payment_profile_path, :class => "btn btn-primary"
  - else
    = simple_form_for( @payment, :url => customer_payments_path, :html => { :class => 'well' } ) do |f|
      = f.error_notification
      - @payment.errors.full_messages.each do |msg|
        = msg
      = f.association :lease, :default => @current_customer.active_leases.first, :collection => @current_customer.active_leases, :label_method => :name, :value_method => :id
      = f.association :payment_profile, :default => @current_customer.payment_profiles.first, :collection => @current_customer.payment_profiles, :label_method => :name, :value_method => :id
      = f.input :total, :as => :string
        
      = f.button :submit, :label => 'Save', :value => 'Save', :class => 'btn btn-primary'
      = link_to "Cancel", customer_payments_path, :class => 'btn'